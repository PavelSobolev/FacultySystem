<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
	<title>
		Доступ к файловой системе.
	</title>
  <HTA:APPLICATION 
     ID="ht"
     APPLICATIONNAME="myApp"
	 BORDER="thick" BORDERSTYLE="normal" INNERBORDER = "no"  CAPTION="yes"
	 ICON="D:\Program Files(x86)\Common Files\Borland Shared\Images\Icons\factory.ico"
	 MAXIMIZEBUTTON="yes" MINIMIZEBUTTON="yes" SHOWINTASKBAR="yes" SINGLEINSTANCE="no"
	 SYSMENU="yes" WINDOWSTATE="normal" CONTEXTMENU = "no" SCROLLFLAT = "yes"
	 SCROLL = "no" SELECTION = "no" VERSION = "1.0" NAVIGABLE = "yes">
	 
  <script language=jscript>
  
  function show() //вывести список каталогов и файлов
  {
  	var fso = new ActiveXObject("Scripting.FileSystemObject");
  	text1.value = "";
  	var path = "C:\\Aqua\\Visual Studio 2008\\Projects\\ИС Факультет\\Факультет";
  	
  	/*if (fso.FolderExists(path))
  	text1.value = text1.value + "Найдена системная папка С:\\Windows. " +
  		"Вот ее содержимое: \n Вложенные папки:\n\n\t";
  	else
  	{
  		text1.value = text1.value + "Системная папка " +  path +  " не найдена.";
  		return;
  	}*/
  	
  	var F = fso.GetFolder(path);
  	var SubFolders = new Enumerator(F.SubFolders);
  	var content = "";
  	
  	var fs=0,fds = 0;
  	
  	/*for (;!SubFolders.atEnd(); SubFolders.moveNext())
  	{  	    
  		content = content + SubFolders.item() + ", размер: " + SubFolders.item().Size + " байт\n\t";
  		fds++;
  	}
  	
  	text1.value = text1.value + content;*/
  	
  	text1.value = text1.value + "\nВложенные файлы:\n\n\t";
  	var content = "";
  	var Files = new Enumerator(F.Files)
  	for (; !Files.atEnd(); Files.moveNext())
  	{
  	    content = content + Files.item();   //+ ", размер: " + Files.item().Size + " байт\n\t";
  		fs++;
  	}
  	
  	text1.value = text1.value + content;
  	
  	text1.value = text1.value + "-------------------------------------------------------------\n";
  	text1.value = text1.value + "Всего файлов: " + fs + ".";
  	
}
  
  </script>
</head>

<body bgcolor="buttonface">

<!-- область вывода текста -->
<textarea id="text1" style="width:100%; height:88%;"></textarea>

<br>

<!-- кнопка для запуска процесса вывода  -->
<button value="Нажми" onclick="show()">Вывести статистику каталога проекта</button>
<br>

</body>
</html> 
